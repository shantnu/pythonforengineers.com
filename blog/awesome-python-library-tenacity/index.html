<!DOCTYPE html>
<html lang="en">
<head>

    <title>Awesome Python Library: Tenacity</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="../../assets/built/screen.css" />

    <link rel="canonical" href="index.html">
    <meta name="referrer" content="no-referrer-when-downgrade">


    <meta property="og:site_name" content="Python for Engineers">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Awesome Python Library: Tenacity">
    <meta property="og:description" content="Link: https://tenacity.readthedocs.io/en/latest/

When writing code or tests in Python, one issue I had was when the code would fail due to random things like network issues or external peripherals not responding in time. Just rerunning the tests would make them pass. The unreliability wasn&#x27;t in">
    <meta property="og:url" content="https://new.pythonforengineers.com/blog/awesome-python-library-tenacity/">
    <meta property="article:published_time" content="2024-04-10T18:01:12.000Z">
    <meta property="article:modified_time" content="2024-04-10T18:01:12.000Z">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Awesome Python Library: Tenacity">
    <meta name="twitter:description" content="Link: https://tenacity.readthedocs.io/en/latest/

When writing code or tests in Python, one issue I had was when the code would fail due to random things like network issues or external peripherals not responding in time. Just rerunning the tests would make them pass. The unreliability wasn&#x27;t in">
    <meta name="twitter:url" content="https://new.pythonforengineers.com/blog/awesome-python-library-tenacity/">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Shantnu Tiwari">

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Python for Engineers",
        "url": "https://new.pythonforengineers.com/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://new.pythonforengineers.com/favicon.ico"
        }
    },
    "author": {
        "@type": "Person",
        "name": "Shantnu Tiwari",
        "image": {
            "@type": "ImageObject",
            "url": "https://new.pythonforengineers.com/content/images/2021/08/shantnu-foto-small-1.jpg"
        },
        "url": "https://new.pythonforengineers.com/author/shantnu/",
        "sameAs": []
    },
    "headline": "Awesome Python Library: Tenacity",
    "url": "https://new.pythonforengineers.com/blog/awesome-python-library-tenacity/",
    "datePublished": "2024-04-10T18:01:12.000Z",
    "dateModified": "2024-04-10T18:01:12.000Z",
    "description": "Link: https://tenacity.readthedocs.io/en/latest/\n\nWhen writing code or tests in Python, one issue I had was when the code would fail due to random things like network issues or external peripherals not responding in time. Just rerunning the tests would make them pass. The unreliability wasn&#x27;t in the code but in things out of my control, like network issues.\n\nSo I had to add extra code to retry the code, but this added unnecessary complexity.\n\nThats when I discovered the Tenacity library and it s",
    "mainEntityOfPage": "https://new.pythonforengineers.com/blog/awesome-python-library-tenacity/"
}
    </script>

    <meta name="generator" content="Ghost 5.129">
    <link rel="alternate" type="application/rss+xml" title="Python for Engineers" href="../rss/index.html">


    <link href="https://new.pythonforengineers.com/webmentions/receive/" rel="webmention">
    <script defer src="../../public/cards.min.js%3Fv=ddf1563274"></script>
    <link rel="stylesheet" type="text/css" href="../../public/cards.min.css%3Fv=ddf1563274.css">
    <script defer src="../../public/member-attribution.min.js%3Fv=ddf1563274"></script><style>:root {--ghost-accent-color: #FF1A75;}</style>
    <link rel="stylesheet" href="/assets/css/prism-okaidia.min.css" integrity="sha512-mIs9kKbaw6JZFfSuo+MovjU+Ntggfoj8RwAmJbVXQ5mkAX5LlgETQEweFPI18humSPHymTb5iikEOKWF7I8ncQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="/assets/css/prism-toolbar.min.css" />

</head>
<body class="post-template">
<div class="viewport">

    <header id="gh-head" class="gh-head ">
        <nav class="gh-head-inner inner gh-container">

            <div class="gh-head-brand">
                <a class="gh-head-logo" href="../../home/index.html">
                        Python for Engineers
                </a>
                <a class="gh-burger" role="button">
                    <div class="gh-burger-box">
                        <div class="gh-burger-inner"></div>
                    </div>
                </a>
            </div>
            <div class="gh-head-menu">
                <ul class="nav">
    <li class="nav-home"><a href="../../home/index.html">Home</a></li>
    <li class="nav-about-contact"><a href="../../about/index.html">About/Contact</a></li>
    <li class="nav-books"><a href="../../books.html">Books</a></li>
    <li class="nav-blog"><a href="../../author/Shantnu/index.html">Blog</a></li>
    <li class="nav-search"><a href="index.html#/search">Search</a></li>
</ul>

            </div>

        </nav>
    </header>

    <main>




<article class="article post no-image">

    <header class="article-header gh-canvas">


        <h1 class="article-title">Awesome Python Library: Tenacity</h1>


        <div class="article-byline">
            <section class="article-byline-content">
                <ul class="author-list">
                    <li class="author-list-item">
                        <a href="../../author/Shantnu/index.html" class="author-avatar">
                            <img class="author-profile-image" src="../../content/images/size/w100/2021/08/shantnu-foto-small-1.jpg" alt="Shantnu Tiwari" />
                        </a>
                    </li>
                </ul>
                <div class="article-byline-meta">
                    <h4 class="author-name"><a href="../../author/Shantnu/index.html">Shantnu Tiwari</a></h4>
                    <div class="byline-meta-content">
                        <time class="byline-meta-date" datetime="2024-04-10">Apr 10, 2024</time>
                        <span class="byline-reading-time"><span class="bull">&bull;</span> 2 min read</span>
                    </div>
                </div>
            </section>
        </div>

    </header>

    <section class="gh-content gh-canvas">
        <figure class="kg-card kg-embed-card"><iframe width="200" height="113" src="https://www.youtube.com/embed/aO3pQ1Ff1d0?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="" title="Awesome Python Library: Tenacity"></iframe></figure><p></p><p>Link: <a href="https://tenacity.readthedocs.io/en/latest/?ref=new.pythonforengineers.com">https://tenacity.readthedocs.io/en/latest/</a></p><p>When writing code or tests in Python, one issue I had was when the code would fail due to random things like network issues or external peripherals not responding in time. Just rerunning the tests would make them pass. The unreliability wasn't in the code but in things out of my control, like network issues.</p><p>So I had to add extra code to retry the code, but this added unnecessary complexity.</p><p>Thats when I discovered the Tenacity library and it saved me hours and a lot of useless boilerplate code.</p><h3 id="some-unreliable-code">Some unreliable code</h3><p></p><p></p><p>Let's try some dummy  unreliable code.</p><pre><code>import time
import random


FAIL_PERCENT= 0.7 # 70% of time

def unreliable_function():
    print("In unreliable function:")
    if random.random() &lt; FAIL_PERCENT:
        raise Exception("Operation failed randomly")
    else:
        # Successful operation
        return "Success"
</code></pre>
<p>The code uses the random function to throw an exception 70% of the time. Try running it, it will fail more often than not.</p><p>Normally, I would add some code to retry the code on failure:</p><pre><code class="language-python">for i in range(10):
    try:
        unreliable_function()
        print("passed, yay!")
        break
    except Exception as e:
        print("Function returned error, sleeping")
        time.sleep(1)</code></pre><p>Running it, I get output like:</p><pre><code>In unreliable function:
Function returned error, sleeping
In unreliable function:
Function returned error, sleeping
In unreliable function:
Function returned error, sleeping
In unreliable function:
passed, yay!</code></pre><p>So the code works, but I have to manually add try excepts and a sleep. And then I have to maintain the code. </p><p></p><h3 id="tenacity-retry-on-failure">Tenacity: Retry on failure</h3><p></p><p>Let's see how we can retry the buggy code with Tenacity:</p><pre><code>@retry    # &lt;-- This is the only NEW code
def unreliable_function():
    print("In unreliable function:")
    if random.random() &lt; FAIL_PERCENT:
        raise Exception("Operation failed randomly")
    else:
        # Successful operation
        return "Success"

unreliable_function()</code></pre><p>The simplest thing is to just add the <em>@retry decorator</em> to the code. It will keep running the code if it passes.</p><p>The fact you have no extra code, just a decorator, means the code is really easy to follow when someone else picks up your code a few months/years from now.</p><p>But what if we want to only try X times, and sleep in between tries?</p><pre><code>@retry(wait = wait_fixed(1), stop = stop_after_attempt(8))
def unreliable_function():
    print("In unreliable function:")
    if random.random() &lt; FAIL_PERCENT:
        raise Exception("Operation failed randomly")
    else:
        # Successful operation
        return "Success"

unreliable_function()</code></pre><pre><code>In unreliable function:
In unreliable function:
In unreliable function:

'Success'</code></pre><p>The <em>wait = wait_fixed(1) </em>will wait 1 second between runs. Instead of wait_fixed we can also wait a random time, or <em>wait_exponential() </em>which will increase the time exponentially.</p><p><em>stop = stop_after_attempt(8)</em> will stop after 8 tries. You can also set a maximum timeout– like the code must fail after 30 seconds.</p><p><strong>Adding multiple conditions</strong></p><p>We can also chain conditions. So for example, you want to wait between retries, but you don't want to spend hours on it as you have other things  to do (or you might have other tests to run, and want to fail early).</p><pre><code>@retry(stop=(stop_after_attempt(10)  | stop_after_delay(30) ) )</code></pre><p>The above will retry the code 10 times, but for a maximum of 30 seconds. If after 30 seconds, the code is still failing, it will return with the error message.</p><p>Another cool function if Custom Callbacks, where you can have your own test to check if the code failed.</p><p>Say you are reading a webpage and it returns a 500 server error HTTP code. While there has been no exception, the code still failed.</p><p>In this case, you can write your own custom code to check the HTTP code is 200.</p><h3 id="in-conclusion">In conclusion</h3><p></p><p>I wasted  a lot of time writing my own code to retry functions in various cases, and it became complex and unmanageable soon. Tenacity is so simple to use, I recommend just using it.</p>
    </section>


</article>



<aside class="read-more-wrap">
    <div class="read-more inner">



<article class="post-card post no-image ">


    <div class="post-card-content">

        <a class="post-card-content-link" href="../so-evidently/index.html">
            <header class="post-card-header">
                <h2 class="post-card-title">So Google&#x27;s Gemini Doesn&#x27;t Like Python Programming and Sanskrit?</h2>
            </header>
            <section class="post-card-excerpt">
                <p>I have been playing around with Googles Gemini Pro.

Recently, I wanted to write a blog on Python&#39;s decorators and wanted to get some ideas for practical projects I could build with them. Tried GPT4 first, it gave me the standard &quot;log analyser&quot; that all blogs</p>
            </section>
        </a>

        <footer class="post-card-meta">
            <ul class="author-list">
                <li class="author-list-item">
                    <a href="../../author/Shantnu/index.html" class="static-avatar">
                        <img class="author-profile-image" src="../../content/images/size/w100/2021/08/shantnu-foto-small-1.jpg" alt="Shantnu Tiwari" />
                    </a>
                </li>
            </ul>
            <div class="post-card-byline-content">
                <span><a href="../../author/Shantnu/index.html">Shantnu Tiwari</a></span>
                <span class="post-card-byline-date"><time datetime="2024-02-25">Feb 25, 2024</time> <span class="bull">&bull;</span> 4 min read</span>
            </div>
        </footer>

    </div>

</article>

<article class="post-card post ">

    <a class="post-card-image-link" href="../linkedin-has-become-a-piece-of-garbage-even-more-than-usual/index.html">
        <img class="post-card-image"
            srcset="../../content/images/size/w300/2024/01/ae223740-840b-4d4a-9467-2522a67dcbbc.png 300w,
                   ../../content/images/size/w600/2024/01/ae223740-840b-4d4a-9467-2522a67dcbbc.pngg 600w,
                  ../../content/images/size/w1000/2024/01/ae223740-840b-4d4a-9467-2522a67dcbbc.pngng 1000w,
                 ../../content/images/size/w2000/2024/01/ae223740-840b-4d4a-9467-2522a67dcbbc.pngpng 2000w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="../../content/images/size/w600/2024/01/ae223740-840b-4d4a-9467-2522a67dcbbc.png"
            alt="LinkedIn Has Become a Pile of Garbage (even more than usual)"
            loading="lazy"
        />
    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="../linkedin-has-become-a-piece-of-garbage-even-more-than-usual/index.html">
            <header class="post-card-header">
                <h2 class="post-card-title">LinkedIn Has Become a Pile of Garbage (even more than usual)</h2>
            </header>
            <section class="post-card-excerpt">
                <p>Online forums, especially Hacker News and Reddit, are very hostile to LinkedIn. Everyone makes fun of the self-promotion and silliness that goes there. There are complaints the site is unusable, which I didn&#39;t agree with until now.

I&#39;ve had an account there for a few years.</p>
            </section>
        </a>

        <footer class="post-card-meta">
            <ul class="author-list">
                <li class="author-list-item">
                    <a href="../../author/Shantnu/index.html" class="static-avatar">
                        <img class="author-profile-image" src="../../content/images/size/w100/2021/08/shantnu-foto-small-1.jpg" alt="Shantnu Tiwari" />
                    </a>
                </li>
            </ul>
            <div class="post-card-byline-content">
                <span><a href="../../author/Shantnu/index.html">Shantnu Tiwari</a></span>
                <span class="post-card-byline-date"><time datetime="2024-01-29">Jan 29, 2024</time> <span class="bull">&bull;</span> 4 min read</span>
            </div>
        </footer>

    </div>

</article>

<article class="post-card post no-image ">


    <div class="post-card-content">

        <a class="post-card-content-link" href="../the-techbros-hypcricy-about-ai-and-ip-theft-is-icnredible/index.html">
            <header class="post-card-header">
                <h2 class="post-card-title">The Tech Bro&#x27;s Hypocrisy about AI and IP Theft is Incredible</h2>
            </header>
            <section class="post-card-excerpt">
                <p>Some time ago there was a post that Github(owned by Microsoft) was training its data on public code repos. And there was predictable outrage about code being &quot;stolen&quot; by a greedy corporation.

The key thing is: Most of the programmers had willingly put their code on GitHub</p>
            </section>
        </a>

        <footer class="post-card-meta">
            <ul class="author-list">
                <li class="author-list-item">
                    <a href="../../author/Shantnu/index.html" class="static-avatar">
                        <img class="author-profile-image" src="../../content/images/size/w100/2021/08/shantnu-foto-small-1.jpg" alt="Shantnu Tiwari" />
                    </a>
                </li>
            </ul>
            <div class="post-card-byline-content">
                <span><a href="../../author/Shantnu/index.html">Shantnu Tiwari</a></span>
                <span class="post-card-byline-date"><time datetime="2024-01-19">Jan 19, 2024</time> <span class="bull">&bull;</span> 3 min read</span>
            </div>
        </footer>

    </div>

</article>

    </div>
</aside>


    </main>

    <footer class="site-footer outer">
        <div class="inner">
            <section class="copyright"><a href="../../home/index.html">Python for Engineers</a> &copy; 2025</section>
            <nav class="site-footer-nav">

            </nav>


        </div>
    </footer>

</div>


<script
    src="/assets/js/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous">
</script>
<script src="../../assets/built/casper.js"></script>
<script>
$(document).ready(function () {
    // Mobile Menu Trigger
    $('.gh-burger').click(function () {
        $('body').toggleClass('gh-head-open');
    });
    // FitVids - Makes video embeds responsive
    $(".gh-content").fitVids();
});
</script>

<script src="/assets/js/prism.min.js" integrity="sha512-axJX7DJduStuBB8ePC8ryGzacZPr3rdLaIDZitiEgWWk2gsXxEFlm4UW0iNzj2h3wp5mOylgHAzBzM4nRSvTZA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>



<script src="/assets/js/prism-toolbar.min.js" integrity="sha512-YrvgEHAi5/3o2OT+/vh1z19oJXk/Kk0qdVKbjEFl9VRmcLTaWRYzVziZCvoGpJ2TrnV7rB8pnJcz1ioVJjgw2A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

</body>
</html>
