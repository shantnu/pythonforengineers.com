<!DOCTYPE html>
<html lang="en">
<head>

    <title>Adding Obstacles and Coins to Our Level</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="../../assets/built/screen.css" />

    <link rel="canonical" href="index.html">
    <meta name="referrer" content="no-referrer-when-downgrade">


    <meta property="og:site_name" content="Python for Engineers">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Adding Obstacles and Coins to Our Level">
    <meta property="og:description" content="This is Part 4 of the Godot series. Read Previous Parts here.
[https://new.pythonforengineers.com/godot-games-programming/]

All the code is here [https://github.com/shantnu/godot-beginners], under Part 4

The problem in our previous code was if we fell over the edge, we kept falling.

We need to detect">
    <meta property="og:url" content="https://new.pythonforengineers.com/blog/adding-obstacles-and-coins-to-our-level/">
    <meta property="article:published_time" content="2022-01-10T15:39:26.000Z">
    <meta property="article:modified_time" content="2022-01-10T15:39:26.000Z">
    <meta property="article:tag" content="game">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Adding Obstacles and Coins to Our Level">
    <meta name="twitter:description" content="This is Part 4 of the Godot series. Read Previous Parts here.
[https://new.pythonforengineers.com/godot-games-programming/]

All the code is here [https://github.com/shantnu/godot-beginners], under Part 4

The problem in our previous code was if we fell over the edge, we kept falling.

We need to detect">
    <meta name="twitter:url" content="https://new.pythonforengineers.com/blog/adding-obstacles-and-coins-to-our-level/">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Shantnu Tiwari">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="game">

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Python for Engineers",
        "url": "https://new.pythonforengineers.com/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://new.pythonforengineers.com/favicon.ico"
        }
    },
    "author": {
        "@type": "Person",
        "name": "Shantnu Tiwari",
        "image": {
            "@type": "ImageObject",
            "url": "https://new.pythonforengineers.com/content/images/2021/08/shantnu-foto-small-1.jpg"
        },
        "url": "https://new.pythonforengineers.com/author/shantnu/",
        "sameAs": []
    },
    "headline": "Adding Obstacles and Coins to Our Level",
    "url": "https://new.pythonforengineers.com/blog/adding-obstacles-and-coins-to-our-level/",
    "datePublished": "2022-01-10T15:39:26.000Z",
    "dateModified": "2022-01-10T15:39:26.000Z",
    "keywords": "game",
    "description": "This is Part 4 of the Godot series. Read Previous Parts here.\n[https://new.pythonforengineers.com/godot-games-programming/]\n\nAll the code is here [https://github.com/shantnu/godot-beginners], under Part 4\n\nThe problem in our previous code was if we fell over the edge, we kept falling.\n\nWe need to detect and correct this. There are multiple ways to do it:\n\n * The easiest way is to have the level closed off, so the player can never\n   fall. This is a design fix\n * You can do a simple check, so if ",
    "mainEntityOfPage": "https://new.pythonforengineers.com/blog/adding-obstacles-and-coins-to-our-level/"
}
    </script>

    <meta name="generator" content="Ghost 5.129">
    <link rel="alternate" type="application/rss+xml" title="Python for Engineers" href="../rss/index.html">


    <link href="https://new.pythonforengineers.com/webmentions/receive/" rel="webmention">
    <script defer src="../../public/cards.min.js%3Fv=ddf1563274"></script>
    <link rel="stylesheet" type="text/css" href="../../public/cards.min.css%3Fv=ddf1563274.css">
    <script defer src="../../public/member-attribution.min.js%3Fv=ddf1563274"></script><style>:root {--ghost-accent-color: #FF1A75;}</style>
    <link rel="stylesheet" href="/assets/css/prism-okaidia.min.css" integrity="sha512-mIs9kKbaw6JZFfSuo+MovjU+Ntggfoj8RwAmJbVXQ5mkAX5LlgETQEweFPI18humSPHymTb5iikEOKWF7I8ncQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="/assets/css/prism-toolbar.min.css" />

</head>
<body class="post-template tag-game">
<div class="viewport">

    <header id="gh-head" class="gh-head ">
        <nav class="gh-head-inner inner gh-container">

            <div class="gh-head-brand">
                <a class="gh-head-logo" href="../../home/index.html">
                        Python for Engineers
                </a>
                <a class="gh-burger" role="button">
                    <div class="gh-burger-box">
                        <div class="gh-burger-inner"></div>
                    </div>
                </a>
            </div>
            <div class="gh-head-menu">
                <ul class="nav">
    <li class="nav-home"><a href="../../home/index.html">Home</a></li>
    <li class="nav-about-contact"><a href="../../about/index.html">About/Contact</a></li>
    <li class="nav-books"><a href="../../books.html">Books</a></li>
    <li class="nav-blog"><a href="../../author/Shantnu/index.html">Blog</a></li>
    <li class="nav-search"><a href="index.html#/search">Search</a></li>
</ul>

            </div>

        </nav>
    </header>

    <main>




<article class="article post tag-game no-image">

    <header class="article-header gh-canvas">

        <section class="article-tag">
            <a href="../../tag/game/index.html">game</a>
        </section>

        <h1 class="article-title">Adding Obstacles and Coins to Our Level</h1>


        <div class="article-byline">
            <section class="article-byline-content">
                <ul class="author-list">
                    <li class="author-list-item">
                        <a href="../../author/Shantnu/index.html" class="author-avatar">
                            <img class="author-profile-image" src="../../content/images/size/w100/2021/08/shantnu-foto-small-1.jpg" alt="Shantnu Tiwari" />
                        </a>
                    </li>
                </ul>
                <div class="article-byline-meta">
                    <h4 class="author-name"><a href="../../author/Shantnu/index.html">Shantnu Tiwari</a></h4>
                    <div class="byline-meta-content">
                        <time class="byline-meta-date" datetime="2022-01-10">Jan 10, 2022</time>
                        <span class="byline-reading-time"><span class="bull">&bull;</span> 6 min read</span>
                    </div>
                </div>
            </section>
        </div>

    </header>

    <section class="gh-content gh-canvas">
        <p>This is Part 4 of the Godot series. Read <a href="../../godot-games-programming/index.html">Previous Parts here.</a></p><p>All the <a href="https://github.com/shantnu/godot-beginners?ref=new.pythonforengineers.com">code is here</a>, under Part 4</p><p>The problem in our previous code was if we fell over the edge, we kept falling.</p><p>We need to detect and correct this. There are multiple ways to do it:</p><ul><li>The easiest way is to have the level closed off, so the player can never fall. This is a design fix</li><li>You can do a simple check, so if the player goes below a certain y axis level, it would kill the player. This is simple but very inelegant.</li><li>A better way is to have a "fall detect" zone, so if the player enters it (by falling, for example), we can take action, like respawning the player.</li></ul><p>The 3rd way is the most elegant and teaches us useful skills that can be used in other situations.</p><p>The way to create this fall zone is: On Level1, add a new node Area2d, and a child node CollisionShape2d:</p><p></p><figure class="kg-card kg-image-card"><img src="../../content/images/2021/12/image-36.png" class="kg-image" alt loading="lazy" width="246" height="232"></figure><p>Rename Area2d to fallzone, and for CollisionShape2d, choose rectangle</p><p></p><figure class="kg-card kg-image-card"><img src="../../content/images/2021/12/image-37.png" class="kg-image" alt loading="lazy" width="349" height="499"></figure><p>We now want to move fallzone. To make our job easy, with fallzone selected, click this:</p><figure class="kg-card kg-image-card"><img src="../../content/images/2021/12/image-38.png" class="kg-image" alt loading="lazy" width="1258" height="361" srcset="../../content/images/size/w600/2021/12/image-38.png 600w, ../../content/images/size/w1000/2021/12/image-38.png 1000w, ../../content/images/2021/12/image-38.png 1258w" sizes="(min-width: 720px) 720px"></figure><p>It will ensure when we move fallzone, the children also move. Now we can move fallzone to below the level:</p><figure class="kg-card kg-image-card"><img src="../../content/images/2021/12/p37.gif" class="kg-image" alt loading="lazy" width="1555" height="699"></figure><p>Now, resize the fallzone. Select CollisionShape2d, and make sure it covers all teh empty area below the level:</p><figure class="kg-card kg-image-card"><img src="../../content/images/2021/12/p38.gif" class="kg-image" alt loading="lazy" width="1554" height="699"></figure><p>Im not bothering to have the fallzone to the left of the screen, as the high wall on the left means I cannot fall off that way (though if this changes, we'll haveto update the fallzone).</p><p>So we now have this fallzone below our level:</p><figure class="kg-card kg-image-card"><img src="../../content/images/2021/12/image-39.png" class="kg-image" alt loading="lazy" width="1375" height="499" srcset="../../content/images/size/w600/2021/12/image-39.png 600w, ../../content/images/size/w1000/2021/12/image-39.png 1000w, ../../content/images/2021/12/image-39.png 1375w" sizes="(min-width: 720px) 720px"></figure><p>How does it help us? Well, we can now write some code to detect when our player enters this fall zone, and what to do when it does.</p><p><strong>Code to detect when the player enters fallzone</strong></p><p>Click on fall zone, and on the right, next to Inspector, you will see a N<em>ode </em>menu. In this menu is a <em>body_entered</em> function. </p><p>This function will trigger a signal when any body (player or otherwise) enters it, and which will then allow us to call some code.</p><p>Double click it:</p><figure class="kg-card kg-image-card"><img src="../../content/images/2021/12/image-40.png" class="kg-image" alt loading="lazy" width="1912" height="517" srcset="../../content/images/size/w600/2021/12/image-40.png 600w, ../../content/images/size/w1000/2021/12/image-40.png 1000w, ../../content/images/size/w1600/2021/12/image-40.png 1600w, ../../content/images/2021/12/image-40.png 1912w" sizes="(min-width: 720px) 720px"></figure><p>We now need to connect it to a script. Choose Player and click connect:</p><figure class="kg-card kg-image-card"><img src="../../content/images/2021/12/image-41.png" class="kg-image" alt loading="lazy" width="652" height="576" srcset="../../content/images/size/w600/2021/12/image-41.png 600w, ../../content/images/2021/12/image-41.png 652w"></figure><p></p><p>In the player.gd script, you should see a new function:</p><pre><code>func _on_fallzone_body_entered(body):
	pass # Replace with function body.</code></pre><p>We need to update the code here. We can do a lot of fancy stuff, but for now, we will just restart the level. Update the code:</p><pre><code>func _on_fallzone_body_entered(body):
	get_tree().change_scene("res://level1.tscn")</code></pre><p>get_tree() gets all the root level functions, and on that, we change the scene to our level1.tscn.</p><p>So if you now fall off the edge, the level will restart. Try it out.</p><figure class="kg-card kg-image-card"><img src="../../content/images/2021/12/p39.gif" class="kg-image" alt loading="lazy" width="1554" height="699"></figure><p>And our level just restarts.</p><p>Let's add more hazards now.</p><h3 id="adding-hazards-spikes-to-our-level">Adding hazards (spikes) to our level</h3><p></p><p>From now on, I will move faster, not describing every step, as you should know how to add scenes etc now. If you get stuck, look at previous examples.</p><p>Let's add spikes to our level now. The player will "die" if they touch them, same as falling off a cliff, and respawn.</p><p>Create a new scene, with root as Area2d. Have 2 children– Sprite and CollisionShape2d. Rename the top node to spikes.</p><p>Save it as spikes.tscn</p><figure class="kg-card kg-image-card"><img src="../../content/images/2021/12/image-44.png" class="kg-image" alt loading="lazy" width="243" height="228"></figure><p>For the Sprite, drag spikes_top.png to <em>Texture </em>in the Inspector, and set the shape of CollisionShape2d as a rectangle.</p><p>Draw a rectangle over the spikes to make sure they cover them:</p><figure class="kg-card kg-image-card"><img src="../../content/images/2021/12/image-45.png" class="kg-image" alt loading="lazy" width="426" height="214"></figure><p>To make it easy, make sure you have clicked the box you can't select the children of the node.</p><p>On Level1 screen, add a new Node2d object (a child of Level1) and name it spikes. Why spikes? Because we will be adding multiple spikes to it.</p><p>With spikes selected, make sure you click on "instance to a child scene":</p><figure class="kg-card kg-image-card"><img src="../../content/images/2021/12/image-46.png" class="kg-image" alt loading="lazy" width="682" height="400" srcset="../../content/images/size/w600/2021/12/image-46.png 600w, ../../content/images/2021/12/image-46.png 682w"></figure><p>and select spikes.tscn you created.</p><p>As with the fallzone, we want to detect when a player enters the spike zone. We will use the <em>body_entered()</em> function again and create another script in player.gd.</p><p>Use the same code as before:</p><pre><code>func _on_spikes_body_entered(body):
	get_tree().change_scene("res://level1.tscn")
</code></pre><p>Move the spike to somewhere useful so we can test:</p><figure class="kg-card kg-image-card"><img src="../../content/images/2021/12/image-47.png" class="kg-image" alt loading="lazy" width="508" height="301"></figure><p>and run the code. You should see the level restart:</p><figure class="kg-card kg-image-card"><img src="../../content/images/2021/12/p40.gif" class="kg-image" alt loading="lazy" width="1554" height="699"></figure><p></p><p>Good. Now right click on our spike and duplicate it a few times:</p><figure class="kg-card kg-image-card"><img src="../../content/images/2021/12/image-48.png" class="kg-image" alt loading="lazy" width="540" height="703"></figure><p>and place the spikes in different places.</p><figure class="kg-card kg-image-card"><img src="../../content/images/2021/12/image-49.png" class="kg-image" alt loading="lazy" width="918" height="516" srcset="../../content/images/size/w600/2021/12/image-49.png 600w, ../../content/images/2021/12/image-49.png 918w" sizes="(min-width: 720px) 720px"></figure><p>Make sure you do a quick playthru to ensure the level isnt too hard.</p><p><strong>Adding coins</strong></p><p>Follow the exact same process as for spikes and add a few coins. The only difference is, rather than kill the player, it will give us points.</p><p>this is what is should look like:</p><figure class="kg-card kg-image-card"><img src="../../content/images/2021/12/image-50.png" class="kg-image" alt loading="lazy" width="910" height="667" srcset="../../content/images/size/w600/2021/12/image-50.png 600w, ../../content/images/2021/12/image-50.png 910w" sizes="(min-width: 720px) 720px"></figure><p>Connect the body_entered function to the player script.</p><p>In the player.gd file, add this to the top:</p><pre><code>var coins_found = 0</code></pre><p>And update the function you got:</p><pre><code>func _on_coin_body_entered(body):
	coins_found += 1
	print("coins found =", coins_found)</code></pre><p>Check it works by running the game.</p><p><strong>Removing the coin</strong></p><p>We do see the coin print incrementing, but the coin stays on the screen. The next step is to remove the coin.</p><p>Add a script to the coin.tscn file, and add another _on_coin_body_entered function, but this time in coin.gd</p><pre><code>func _on_coin_body_entered(_body):
	queue_free()</code></pre><p>The queue_free() function deletes the coin.</p><p>Test your code to check the coin vanishes;  </p><figure class="kg-card kg-image-card"><img src="../../content/images/2021/12/p1.gif" class="kg-image" alt loading="lazy" width="480" height="226"></figure><p>then copy the current coin a few times to create multiple coins. Check it works for all. Im going to add 3 coins for now.</p><p>We will fix the print later, so rather than just print the number of coins, it displays it on the screen. But for now, let's add one more condition: If the player collects all the coins, s/he wins.</p><p>For this, we need a new variable TOTAL_COINS. </p><pre><code>var TOTAL_COINS=0</code></pre><p>We could just set it to 3, as we know we have 3 coins, but the problem is, if we later add more coins, the code will fail. we need to dynamically count how many coins we have. Luckily, thats easy in Godot.</p><p>We update the ready function, as it's called everytime the scene is ready:</p><pre><code>func _ready():
	coins_found = 0
	TOTAL_COINS=get_parent().get_node("coins").get_child_count()</code></pre><p>The first line, coins_found=0 – Im fixing a bug, as if you died, it remembered how many coins you had. This way, everytime the scene reloads, coins are set to zero.</p><p>In the 2nd line, we get the parent node, and then the child node coins. Visually:</p><figure class="kg-card kg-image-card"><img src="../../content/images/2021/12/image-51.png" class="kg-image" alt loading="lazy" width="448" height="600"></figure><p>We go up to Level 1, then get child node coins, and count the number of children in, which will give us the number of coins.</p><p>The advantage now is, if we add more coins, the code will keep working.</p><p>Test it out, and confirm you win when you get all 3 coins.</p><p>Later on, we'll add a proper win screen. For now, let's add some enemies.</p><p><em>Note: I found a critical bug that froze my code– it was because I wasn't using layers properly. In  a quick post, I will explain how layer masks work in Godot.</em></p>
    </section>


</article>



<aside class="read-more-wrap">
    <div class="read-more inner">



<article class="post-card post no-image ">


    <div class="post-card-content">

        <a class="post-card-content-link" href="../awesome-python-library-tenacity/index.html">
            <header class="post-card-header">
                <h2 class="post-card-title">Awesome Python Library: Tenacity</h2>
            </header>
            <section class="post-card-excerpt">
                <p>Link: https://tenacity.readthedocs.io/en/latest/

When writing code or tests in Python, one issue I had was when the code would fail due to random things like network issues or external peripherals not responding in time. Just rerunning the tests would make them pass. The unreliability wasn&#39;</p>
            </section>
        </a>

        <footer class="post-card-meta">
            <ul class="author-list">
                <li class="author-list-item">
                    <a href="../../author/Shantnu/index.html" class="static-avatar">
                        <img class="author-profile-image" src="../../content/images/size/w100/2021/08/shantnu-foto-small-1.jpg" alt="Shantnu Tiwari" />
                    </a>
                </li>
            </ul>
            <div class="post-card-byline-content">
                <span><a href="../../author/Shantnu/index.html">Shantnu Tiwari</a></span>
                <span class="post-card-byline-date"><time datetime="2024-04-10">Apr 10, 2024</time> <span class="bull">&bull;</span> 2 min read</span>
            </div>
        </footer>

    </div>

</article>

<article class="post-card post no-image ">


    <div class="post-card-content">

        <a class="post-card-content-link" href="../so-evidently/index.html">
            <header class="post-card-header">
                <h2 class="post-card-title">So Google&#x27;s Gemini Doesn&#x27;t Like Python Programming and Sanskrit?</h2>
            </header>
            <section class="post-card-excerpt">
                <p>I have been playing around with Googles Gemini Pro.

Recently, I wanted to write a blog on Python&#39;s decorators and wanted to get some ideas for practical projects I could build with them. Tried GPT4 first, it gave me the standard &quot;log analyser&quot; that all blogs</p>
            </section>
        </a>

        <footer class="post-card-meta">
            <ul class="author-list">
                <li class="author-list-item">
                    <a href="../../author/Shantnu/index.html" class="static-avatar">
                        <img class="author-profile-image" src="../../content/images/size/w100/2021/08/shantnu-foto-small-1.jpg" alt="Shantnu Tiwari" />
                    </a>
                </li>
            </ul>
            <div class="post-card-byline-content">
                <span><a href="../../author/Shantnu/index.html">Shantnu Tiwari</a></span>
                <span class="post-card-byline-date"><time datetime="2024-02-25">Feb 25, 2024</time> <span class="bull">&bull;</span> 4 min read</span>
            </div>
        </footer>

    </div>

</article>

<article class="post-card post ">

    <a class="post-card-image-link" href="../linkedin-has-become-a-piece-of-garbage-even-more-than-usual/index.html">
        <img class="post-card-image"
            srcset="../../content/images/size/w300/2024/01/ae223740-840b-4d4a-9467-2522a67dcbbc.png 300w,
                   ../../content/images/size/w600/2024/01/ae223740-840b-4d4a-9467-2522a67dcbbc.pngg 600w,
                  ../../content/images/size/w1000/2024/01/ae223740-840b-4d4a-9467-2522a67dcbbc.pngng 1000w,
                 ../../content/images/size/w2000/2024/01/ae223740-840b-4d4a-9467-2522a67dcbbc.pngpng 2000w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="../../content/images/size/w600/2024/01/ae223740-840b-4d4a-9467-2522a67dcbbc.png"
            alt="LinkedIn Has Become a Pile of Garbage (even more than usual)"
            loading="lazy"
        />
    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="../linkedin-has-become-a-piece-of-garbage-even-more-than-usual/index.html">
            <header class="post-card-header">
                <h2 class="post-card-title">LinkedIn Has Become a Pile of Garbage (even more than usual)</h2>
            </header>
            <section class="post-card-excerpt">
                <p>Online forums, especially Hacker News and Reddit, are very hostile to LinkedIn. Everyone makes fun of the self-promotion and silliness that goes there. There are complaints the site is unusable, which I didn&#39;t agree with until now.

I&#39;ve had an account there for a few years.</p>
            </section>
        </a>

        <footer class="post-card-meta">
            <ul class="author-list">
                <li class="author-list-item">
                    <a href="../../author/Shantnu/index.html" class="static-avatar">
                        <img class="author-profile-image" src="../../content/images/size/w100/2021/08/shantnu-foto-small-1.jpg" alt="Shantnu Tiwari" />
                    </a>
                </li>
            </ul>
            <div class="post-card-byline-content">
                <span><a href="../../author/Shantnu/index.html">Shantnu Tiwari</a></span>
                <span class="post-card-byline-date"><time datetime="2024-01-29">Jan 29, 2024</time> <span class="bull">&bull;</span> 4 min read</span>
            </div>
        </footer>

    </div>

</article>

    </div>
</aside>


    </main>

    <footer class="site-footer outer">
        <div class="inner">
            <section class="copyright"><a href="../../home/index.html">Python for Engineers</a> &copy; 2025</section>
            <nav class="site-footer-nav">

            </nav>


        </div>
    </footer>

</div>


<script
    src="/assets/js/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous">
</script>
<script src="../../assets/built/casper.js"></script>
<script>
$(document).ready(function () {
    // Mobile Menu Trigger
    $('.gh-burger').click(function () {
        $('body').toggleClass('gh-head-open');
    });
    // FitVids - Makes video embeds responsive
    $(".gh-content").fitVids();
});
</script>

<script src="/assets/js/prism.min.js" integrity="sha512-axJX7DJduStuBB8ePC8ryGzacZPr3rdLaIDZitiEgWWk2gsXxEFlm4UW0iNzj2h3wp5mOylgHAzBzM4nRSvTZA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>



<script src="/assets/js/prism-toolbar.min.js" integrity="sha512-YrvgEHAi5/3o2OT+/vh1z19oJXk/Kk0qdVKbjEFl9VRmcLTaWRYzVziZCvoGpJ2TrnV7rB8pnJcz1ioVJjgw2A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

</body>
</html>
